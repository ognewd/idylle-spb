# SMTP Configuration Guide

## Что добавлено

1. **Mail Utility** (`src/lib/mail.ts`)
   - Функции для работы с SMTP через nodemailer
   - `getMailTransporter()` - получение настроенного транспортера
   - `sendMail()` - отправка писем
   - `testSMTPConnection()` - тестирование подключения

2. **API Endpoint** (`src/app/api/admin/smtp/route.ts`)
   - `GET` - получение текущих настроек SMTP
   - `POST` - тестирование подключения и отправка тестовых писем

3. **Admin Page** (`src/app/admin/smtp/page.tsx`)
   - Интерфейс для просмотра настроек SMTP
   - Кнопка "Test Connection" для проверки подключения
   - Форма для отправки тестового письма

4. **Environment Variables**
   - `SMTP_HOST` - SMTP сервер
   - `SMTP_PORT` - порт SMTP сервера
   - `SMTP_USER` - имя пользователя
   - `SMTP_PASS` - пароль
   - `SMTP_FROM` - адрес отправителя

## Текущая конфигурация (Mailtrap)

```
SMTP_HOST=sandbox.smtp.mailtrap.io
SMTP_PORT=587
SMTP_USER=3ef9d3f764147b
SMTP_PASS=542432ec5d869c
SMTP_FROM=noreply@idylle.spb.ru
```

## Как использовать

### 1. Открыть админ панель
Перейдите на `http://localhost:3000/admin` и войдите как администратор.

### 2. Найти пункт "SMTP" в меню
В списке разделов админки будет пункт "SMTP" с иконкой письма.

### 3. Проверить настройки
На странице SMTP вы увидите текущие настройки (только для чтения).

### 4. Протестировать подключение
Нажмите кнопку "Test Connection" для проверки подключения к SMTP серверу.

### 5. Отправить тестовое письмо
1. Введите email адрес в поле "Email адрес"
2. Нажмите "Send Test Email"
3. Проверьте Mailtrap Inbox по адресу: https://mailtrap.io/inboxes
4. Письмо должно появиться в Mailtrap (не попадет на реальный адрес)

## Важные замечания

1. **Mailtrap** - это сервис для тестирования email в разработке
2. Письма не отправляются на реальные адреса, а попадают в Mailtrap Inbox
3. Для продакшена нужно использовать реальный SMTP сервер (например, SendGrid, AWS SES, и т.д.)
4. Пароль в интерфейсе отображается как ****** для безопасности

## Дальнейшие шаги

1. **В проде** изменить переменные окружения на реальный SMTP сервер
2. Добавить функционал редактирования настроек через интерфейс (сейчас только чтение)
3. Добавить логирование отправленных писем
4. Интегрировать отправку писем в существующий функционал (заказы, рассылка и т.д.)
