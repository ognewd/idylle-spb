# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ Git push

## ‚ùå –ü—Ä–æ–±–ª–µ–º–∞

```
! [remote rejected]   main -> main (pre-receive hook declined)
error: failed to push some refs to 'https://github.com/ognewd/idylle-spb.git'
```

–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ GitHub –æ—Ç–∫–ª–æ–Ω–∏–ª push. –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:
1. –ë–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã –≤ –∏—Å—Ç–æ—Ä–∏–∏ Git
2. –§–∞–π–ª—ã >100MB
3. –ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –≤ `public/uploads/`

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### –®–∞–≥ 1: –£–¥–∞–ª–∏—Ç—å –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –∏–∑ Git

–ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (`public/uploads/`) –Ω–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ Git. –û–Ω–∏ —É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ `.gitignore`.

–£–¥–∞–ª–∏—Ç—å –∏–∑ –∏–Ω–¥–µ–∫—Å–∞ Git:

```bash
cd /Users/dognev/idylle-spb

# –£–¥–∞–ª–∏—Ç—å –∏–∑ Git –∏–Ω–¥–µ–∫—Å–∞ (—Ñ–∞–π–ª—ã –æ—Å—Ç–∞–Ω—É—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ)
git rm -r --cached public/uploads/

# –£–¥–∞–ª–∏—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –∏–∑ –∏–Ω–¥–µ–∫—Å–∞
git rm --cached "–æ—Å—Ç–∞—Ç–∫–∏ –∏ –®–ö.xls" 2>/dev/null || true
```

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã –≤ –∏—Å—Ç–æ—Ä–∏–∏

–ï—Å–ª–∏ –≤ –∏—Å—Ç–æ—Ä–∏–∏ Git –µ—Å—Ç—å –±–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã, –Ω—É–∂–Ω–æ –æ—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é:

```bash
# –ù–∞–π—Ç–∏ –±–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã –≤ –∏—Å—Ç–æ—Ä–∏–∏
git rev-list --objects --all | \
  git cat-file --batch-check='%(objecttype) %(objectname) %(objectsize) %(rest)' | \
  awk '/^blob/ {print substr($0,6)}' | \
  sort --numeric-sort --key=2 --reverse | \
  head -10
```

### –®–∞–≥ 3: –í–∞—Ä–∏–∞–Ω—Ç—ã —Ä–µ—à–µ–Ω–∏—è

#### –í–∞—Ä–∏–∞–Ω—Ç A: –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å —á–∏—Å—Ç–æ–π –∏—Å—Ç–æ—Ä–∏–µ–π (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)

–°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± - –Ω–∞—á–∞—Ç—å —Å —á–∏—Å—Ç–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è:

```bash
cd /Users/dognev/idylle-spb

# –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
git add .
git commit -m "Clean repository for deployment"

# –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–π remote (–µ—Å–ª–∏ –µ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã)
git remote remove origin 2>/dev/null || true

# –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π remote
git remote add origin https://github.com/ognewd/idylle-spb.git

# –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –≤–µ—Ç–∫—É —Å —á–∏—Å—Ç—ã–º –Ω–∞—á–∞–ª–æ–º
git checkout --orphan clean-main

# –î–æ–±–∞–≤–∏—Ç—å –≤—Å–µ —Ñ–∞–π–ª—ã (–∏—Å–∫–ª—é—á–∞—è .gitignore)
git add .

# –ó–∞–∫–æ–º–º–∏—Ç–∏—Ç—å
git commit -m "Initial commit: Clean repository for Railway deployment"

# –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—É—é –≤–µ—Ç–∫—É main
git branch -D main

# –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å —Ç–µ–∫—É—â—É—é –≤–µ—Ç–∫—É –≤ main
git branch -M main

# –ó–∞–ø—É—à–∏—Ç—å (–ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ, —Ç–∞–∫ –∫–∞–∫ –Ω–æ–≤–∞—è –∏—Å—Ç–æ—Ä–∏—è)
git push -u origin main --force
```

‚ö†Ô∏è **–í–ù–ò–ú–ê–ù–ò–ï:** –≠—Ç–æ —Å–æ–∑–¥–∞—Å—Ç –Ω–æ–≤—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å —á–∏—Å—Ç–æ–π –∏—Å—Ç–æ—Ä–∏–µ–π. –°—Ç–∞—Ä–∞—è –∏—Å—Ç–æ—Ä–∏—è –±—É–¥–µ—Ç –ø–æ—Ç–µ—Ä—è–Ω–∞, –Ω–æ –∫–æ–¥ –æ—Å—Ç–∞–Ω–µ—Ç—Å—è.

#### –í–∞—Ä–∏–∞–Ω—Ç B: –û—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –æ—Ç –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤

–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é, –Ω–æ —É–¥–∞–ª–∏—Ç—å –±–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã:

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å git-filter-repo (–µ—Å–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
brew install git-filter-repo

# –£–¥–∞–ª–∏—Ç—å –ø–∞–ø–∫—É uploads –∏–∑ –≤—Å–µ–π –∏—Å—Ç–æ—Ä–∏–∏
git filter-repo --path public/uploads/ --invert-paths

# –£–¥–∞–ª–∏—Ç—å –±–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏
git filter-repo --strip-blobs-bigger-than 10M
```

–ù–æ —ç—Ç–æ —Å–ª–æ–∂–Ω–µ–µ –∏ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –≤—Ä–µ–º—è.

### –®–∞–≥ 4: –ü—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± - —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

**–°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–±:**

1. **–£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ GitHub** (–µ—Å–ª–∏ —É–∂–µ —Å–æ–∑–¥–∞–Ω):
   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ https://github.com/ognewd/idylle-spb/settings
   - –ü—Ä–æ–∫—Ä—É—Ç–∏—Ç–µ –≤–Ω–∏–∑ –¥–æ "Danger Zone"
   - –ù–∞–∂–º–∏—Ç–µ "Delete this repository"
   - –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ —É–¥–∞–ª–µ–Ω–∏–µ

2. **–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:**
   - https://github.com/new
   - –ù–∞–∑–≤–∞–Ω–∏–µ: `idylle-spb`
   - **–ù–ï –¥–æ–±–∞–≤–ª—è–π—Ç–µ** README, .gitignore, license

3. **–ó–∞–ø—É—à–∏—Ç—å –∫–æ–¥ —Å —á–∏—Å—Ç–æ–π –∏—Å—Ç–æ—Ä–∏–µ–π:**

```bash
cd /Users/dognev/idylle-spb

# –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤—Å–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ
git add .
git status

# –ï—Å–ª–∏ –Ω—É–∂–Ω–æ, —É–¥–∞–ª–∏—Ç—å –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ —Ñ–∞–π–ª—ã –∏–∑ –∏–Ω–¥–µ–∫—Å–∞
git rm -r --cached public/uploads/ 2>/dev/null || true

# –ó–∞–∫–æ–º–º–∏—Ç–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
git commit -m "Initial commit: Clean repository for Railway deployment"

# –ó–∞–ø—É—à–∏—Ç—å
git push -u origin main
```

## ‚úÖ –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –ø—É—à–∞

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞ GitHub:**
   - https://github.com/ognewd/idylle-spb
   - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã

2. **–í–µ—Ä–Ω–∏—Ç–µ—Å—å –≤ Railway:**
   - –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É Railway
   - –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –¥–æ–ª–∂–µ–Ω –ø–æ—è–≤–∏—Ç—å—Å—è
   - –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –Ω–µ–≥–æ –¥–ª—è –¥–µ–ø–ª–æ—è

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –ø—É—à–µ–º

–ü–µ—Ä–µ–¥ –ø—É—à–µ–º —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ:

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑–º–µ—Ä —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
du -sh .git

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –±–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã –Ω–µ –≤ –∏–Ω–¥–µ–∫—Å–µ
git ls-files | xargs du -h 2>/dev/null | sort -rh | head -10

# –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ uploads –Ω–µ –≤ Git
git ls-files | grep uploads
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å –ø—É—Å—Ç–æ
```

